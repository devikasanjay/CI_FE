const safeDisplayedOptions = Array.isArray(displayedOptions)
  ? displayedOptions
  : [];

const areAllFilteredSelected = React.useMemo(() => {
  if (safeDisplayedOptions.length === 0) return false;
  return safeDisplayedOptions.every(opt =>
    selectedValues.includes(opt.id)
  );
}, [selectedValues, safeDisplayedOptions]);

const areSomeFilteredSelected = React.useMemo(() => {
  if (safeDisplayedOptions.length === 0) return false;
  return safeDisplayedOptions.some(opt =>
    selectedValues.includes(opt.id)
  );
}, [selectedValues, safeDisplayedOptions]);
